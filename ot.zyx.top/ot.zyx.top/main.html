<!DOCTYPE html>
<html lang="zh-cn">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>加密 - 在线加密系统</title>

	<script type="text/javascript">
		uojHome = ''; // 'https://sjzezoj.com/';
	</script>

	<!-- Bootstrap 5 (CSS) -->
	<link rel="stylesheet" href="https://sjzezoj.com/css/bootstrap.min.css?v=5.3.0-alpha3" />	<!-- Bootstrap Icons -->
	<link rel="stylesheet" href="https://sjzezoj.com/css/bootstrap-icons.min.css?v=2022.9.23" />
	<!-- Custom styles for this template -->
	<link rel="stylesheet" href="https://sjzezoj.com/css/uoj-bs5.css?v=d627490" />
	<!-- jQuery (necessary for Bootstrap\'s JavaScript plugins) -->
	<script src="https://sjzezoj.com/js/jquery.min.js"></script>
	<!-- jQuery autosize -->
	<script src="https://sjzezoj.com/js/jquery.autosize.min.js"></script>	<script type="text/javascript">
		$(document).ready(function() {
			$('textarea:not([data-no-autosize])').autosize();
		});
	</script>

	<!-- jQuery cookie -->
	<script src="https://sjzezoj.com/js/jquery.cookie.min.js"></script>
	<!-- Bootstrap 5: JavaScript -->
	<script src="https://sjzezoj.com/js/bootstrap.bundle.min.js?v=5.3.0-alpha3"></script>
	<!-- Color converter -->
	<script src="https://sjzezoj.com/js/color-converter.min.js"></script>
	<!-- Clipboard Polyfill -->
	<script src="https://sjzezoj.com/js/clipboard-polyfill.overwrite-globals.es5.min.js"></script>
	<!-- uoj -->
	<script src="https://sjzezoj.com/js/uoj.js?v=d627490"></script>
	<!-- readmore -->
	<script src="https://sjzezoj.com/js/readmore/readmore.min.js"></script>
	<!-- LAB -->
	<script src="https://sjzezoj.com/js/LAB.min.js"></script>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

	<script type="text/javascript">
		before_window_unload_message = null;
		$(window).on('beforeunload', function() {
			if (before_window_unload_message !== null) {
				return before_window_unload_message;
			}
		});
	</script>

	<script async data-domain="sjzezoj.com" src="https://stat.u.sb/js/script.js"></script>
	<script>
		window.plausible = window.plausible || function() {
			(window.plausible.q = window.plausible.q || []).push(arguments)
		}
	</script>
	<script>
		plausible('Domain', {
			props: {
				domain: window.location.host,
			},
		});
	</script>
</head>

<body class="d-flex flex-column min-vh-100
			bg-body-tertiary
			">
			<div class="navbar navbar-light navbar-expand-md bg-body shadow-sm
mb-4
" role="navigation">
	<div class="container">
		<a class="navbar-brand fw-normal" href="../ot.zyx.top.html">
			zyxOT		</a>

		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="nav navbar-nav mr-auto" id="navbarSupportedContent-dock">
				<li class="nav-item">
					<a class="nav-link" href="../ot.zyx.top/main.html">
						<i class="bi bi-card-list"></i>
						加密					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../ot.zyx.top/submit.html">
						<i class="bi bi-pencil-square"></i>
						投食					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../ot.zyx.top/faq.html">
						<i class="bi bi-question-circle"></i>
						帮助					</a>
				</li>
			</ul>

			<hr class="d-md-none text-muted">

			<ul class="nav navbar-nav ms-md-auto">
	<li class="nav-item dropdown">
		<button class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static">
			<i class="bi bi-circle-half theme-icon-active" data-icon="bi-circle-half"></i>
			<span class="d-md-none">&nbsp;切换主题</span>
		</button>
		<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme" style="--bs-dropdown-min-width: 6rem;">
			<li>
				<button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto">
					<i class="bi bi-circle-half me-2 opacity-50 theme-icon" data-icon="bi-circle-half"></i>
					系统
				</button>
			</li>
			<li>
				<button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light">
					<i class="bi bi-sun-fill me-2 opacity-50 theme-icon" data-icon="bi-sun-fill"></i>
					亮色
				</button>
			</li>
			<li>
				<button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark">
					<i class="bi bi-moon-stars-fill me-2 opacity-50 theme-icon" data-icon="bi-moon-stars-fill"></i>
					暗色
				</button>
			</li>
		</ul>
	</li>
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
			<i class="bi bi-translate"></i>
			中文		</a>
		<ul class="dropdown-menu">
			<li>
				<a class="dropdown-item" href="?locale=zh-cn">
					中文
				</a>
			</li>
		</ul>
	</li>
	<li class="nav-item dropdown">
		<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" id="uoj_username_a">
			<span id="uoj_username_page"></span> 						</a>
		<ul class="dropdown-menu">
			<li>
				<a class="dropdown-item" id="my_chat">个人信息</a>
			</li>
		</ul>
	</li>
					<li id="login" class="nav-item" role="presentation"><a class="nav-link" href="../ot.zyx.top/login.html">
				<i class="bi bi-box-arrow-in-right"></i>
				登录			</a>
					<li id="logout" class="nav-item" role="presentation"><a class="nav-link" href="../ot.zyx.top/logout.html">登出</a></li>
								</ul><script type="text/javascript">
							var uoj_username = localStorage.getItem("zyxOT-v1-username");
							if (uoj_username != null) {
								document.querySelector("#uoj_username_page").innerHTML = uoj_username;
								document.querySelector("#my_chat").href = "../ot.zyx.top/user.html?" + uoj_username;
								document.querySelector("#login").remove();
							}
							else {
								document.querySelector("#uoj_username_a").remove();
								document.querySelector("#logout").remove();
							}
						</script>
			</ul>
		</div>

	</div>
</div>

<script>
	var zan_link = '';
</script>
	
	<div class="uoj-content container flex-fill">

<div class="row">
	<div class="col-sm-9 tab-content">

<div class="tab-pane active" id="tab-goto">
	<h1>
	加密</h1>
	<style>
		#text,
		#password {
			font-family: Menlo, Cascadia Mono, Ubuntu Mono, Roboto Mono, Jetbrains Mono, Fira Code, Consolas, '思源黑体 Regular', '思源宋体 Light', '宋体', 'Courier New', monospace;
			width: 100%;
			min-height: 300px;
		}
	</style>
	<div class="card">
		<div class="card-body">
			<div class="row row-cols-1 row-cols-md-2">
				<div class="col">
					<textarea class="form-control" id="text" placeholder="明文"></textarea>
				</div>
				<div class="col">
					<textarea data-no-autosize readonly class="form-control" id="password" placeholder="密文" style="height: 100%"></textarea>
				</div>
			</div>
		</div>
		<div class="card-footer bg-transparent text-end">
			<a href="faq.html#main-goto" target="_blank">使用教程</a>
		</div>
<script>
// 模拟C++中的random_device（简化版）
function getRandomInt(min, max) {
	min = Math.ceil(min);
	max = Math.floor(max);
	// 使用Crypto API获取更安全的随机数（如果可用）
	if (window.crypto && window.crypto.getRandomValues) {
		const array = new Uint32Array(1);
		window.crypto.getRandomValues(array);
		return min + (array[0] % (max - min + 1));
	} else {
		// 后备方案（安全性较低）
		return Math.floor(Math.random() * (max - min + 1)) + min;
	}
}

function pow(x, y) {
	let ret = 1, pw = x;
	for (; y ; y = Math.floor(y / 2)){
		if (y % 2 == 1) ret = ret * pw;
		pw = pw * pw;
	}
	return ret;
}

// Xorshift算法实现
function xorshift(x) {
	const rd = getRandomInt(1, 10);

	output += rd + ' ';
	
	for (let i = 0; i < rd; i++) {
		x ^= x * pow(2, 15);
		x >>>= 0;
		x ^= Math.floor(x / pow(2, 17));
		x >>>= 0;
		x ^= x * pow(2, 3);
		x >>>= 0;
	}
	
	output += x + ' ';

	return;
}

// 加密函数
function go() {
	const s = document.getElementById('text').value;
	
	output = '';
	
	// 输出字符数（模拟C++代码）
	output += s.length + '\n';
	
	let a = [];
	let c = [];
	
	// 处理每个字符
	for (let i = 0; i < s.length; i++) {
		const charCode = s.charCodeAt(i);
		const v = getRandomInt(1, 65536);
		a.push(v);
		
		const v2 = getRandomInt(1, 65536);
		c.push(v2);
		
		// 字符变换: (i * v + v2) % 65537
		let transformed = (charCode * v + v2) % 65537;
		
		// 应用xorshift
		xorshift(transformed);
	}
	
	output += '\n';
	
	// 输出参数a
	for (const val of a) {
		xorshift(val);
	}
	
	output += '\n';
	
	// 输出参数c
	for (const val of c) {
		xorshift(val);
	}
	
	document.getElementById('password').value = output;
	return;
}

let initialValue = "";
document.getElementById('text').addEventListener('input', function(event) {
	if (event.target.value !== initialValue) {
		initialValue = event.target.value;
		// let leng = initialValue.length;
		// for (let i = 0; i < leng - 1; i++) 
		// 	if ((initialValue.substr(i, 2) == 'sb' && initialValue.substr(i - 1, 4) != '.sbs') || initialValue.substr(i, 2) == '傻逼' || initialValue.substr(i, 2) == 'WC' || initialValue.substr(i, 2) == 'wc' || initialValue.substr(i, 2) == '卧槽' || initialValue.substr(i, 2) == '我操' || initialValue.substr(i, 2) == 'TM' || initialValue.substr(i, 2) == 'tm' || initialValue.substr(i, 2) == 'nm' || initialValue.substr(i, 2) == '你妈' || initialValue.substr(i, 2) == '混蛋' || initialValue.substr(i, 2) == '滚蛋' || initialValue.substr(i, 2) == '傻瓜' || initialValue.substr(i, 2) == '他妈' || initialValue.substr(i, 2) == '王八') {
		// 		localStorage.setItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?banned", 1);
		// 		while (!confirm("您已被封禁，触发关键字：" + initialValue.substr(i, 2)));
		// 		localStorage.removeItem("zyxOT-v1-username");
		// 		location.href = localStorage.getItem("zyxOT-v1-deploy") + ":/ot.zyx.top/login.html";
		// 	}
		localStorage.setItem("zyxOT-v1-main-1", Number(localStorage.getItem("zyxOT-v1-main-1")) + 1);
		if (localStorage.getItem("zyxOT-v1-username") != null) 
			localStorage.setItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?main-1", Number(localStorage.getItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?main-1")) + 1);
		go();
	}
});

</script>
	</div></div>

<div class="tab-pane" id="tab-back">
	<h1>
	解密</h1>
	<style>
		#text2,
		#password2 {
			font-family: Menlo, Cascadia Mono, Ubuntu Mono, Roboto Mono, Jetbrains Mono, Fira Code, Consolas, '思源黑体 Regular', '思源宋体 Light', '宋体', 'Courier New', monospace;
			width: 100%;
			min-height: 300px;
		}
	</style>
	<div class="card">
		<div class="card-body">
			<div class="row row-cols-1 row-cols-md-2">
				<div class="col">
					<textarea class="form-control" id="password2" placeholder="密文"></textarea>
				</div>
				<div class="col">
					<textarea data-no-autosize readonly class="form-control" id="text2" placeholder="明文" style="height: 100%"></textarea>
				</div>
			</div>
		</div>
		<div class="card-footer bg-transparent text-end">
			<a href="faq.html#main-back" target="_blank">使用教程</a>
		</div>
<script>
function quickpow(x, y) {
	let ret = 1, pw = x;
	for (; y ; y = Math.floor(y / 2)){
		if (y % 2 == 1) ret = ret * pw % 65537;
		pw = pw * pw % 65537;
	}
	return ret;
}

function qinv(x){
	return quickpow(x, 65537 - 2);
}

function read(s, len, i) {
	for (let j = i; j < len; j++) {
		if (s[j] == ' ' || s[j] == '\n') {
			return Number(s.substring(i, j));
		}
	}
}

function getv(x, y) {
	for (let j = 0; j < x; j++){
		let v = y;
		v >>>= 0;
		// alert(pow(2, 31));
		for (let i = 1;i < pow(2, 32);i *= 2){
			v ^= ((v & i) << 3);
			v >>>= 0;
		}
		for (let i = pow(2, 31);i > 0;i /= 2){
			v ^= ((v & i) >>> 17);
			v >>>= 0;
		}
		for (let i = 1;i < pow(2, 32);i *= 2){
			v ^= ((v & i) << 15);
			v >>>= 0;
		}
		y = v;
	}
	return y;
}

function ba() {
	const t = document.getElementById('password2').value + "\n";
	let a = [], c = [], s = [];
	let len = t.length, i = 0;
	let ans = "";
	let n = read(t, len, i);
	for (let j = i; j < len; j++) 
		if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
			i = j + 1;
			break;
		}
	for (let k = 1; k <= n; k++) {
		let x, y;
		x = read(t, len, i);
		for (let j = i; j < len; j++) 
			if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
				i = j + 1;
				break;
			}
		y = read(t, len, i);
		for (let j = i; j < len; j++) 
			if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
				i = j + 1;
				break;
			}
		a.push(getv(x, y));
	}
	for (let k = 1; k <= n; k++) {
		let x, y;
		x = read(t, len, i);
		for (let j = i; j < len; j++) 
			if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
				i = j + 1;
				break;
			}
		y = read(t, len, i);
		for (let j = i; j < len; j++) 
			if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
				i = j + 1;
				break;
			}
		c.push(getv(x, y));
	}
	for (let k = 1; k <= n; k++) {
		let x, y;
		x = read(t, len, i);
		for (let j = i; j < len; j++) 
			if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
				i = j + 1;
				break;
			}
		y = read(t, len, i);
		for (let j = i; j < len; j++) 
			if (t[j] == ' ' && (t[j + 1] != '\n') || t[j] == '\n') {
				i = j + 1;
				break;
			}
		s.push(getv(x, y));
	}
	for (let i = 0; i < n; i++) 
		ans += String.fromCharCode((a[i] - s[i] + 65537) % 65537 * qinv(c[i]) % 65537);
	document.getElementById('text2').value = ans;
	return;
}

let initialValue2 = "";
document.getElementById('password2').addEventListener('input', function(event2) {
	if (event2.target.value !== initialValue2) {
		initialValue2 = event2.target.value;
		localStorage.setItem("zyxOT-v1-main-2", Number(localStorage.getItem("zyxOT-v1-main-2")) + 1);
		if (localStorage.getItem("zyxOT-v1-username") != null) 
			localStorage.setItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?main-2", Number(localStorage.getItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?main-2")) + 1);
		ba();
	}
});

</script>
	</div>
</div>

		</div>
	<div class="col mt-3 mt-lg-0">
				<div class="card card-default mb-2">
			<div class="card-header fw-bold">
				<i class="bi bi-bar-chart"></i> 操作
			</div>
			<div class="card-body">
				<div class="list-group">								
					<a href="javascript:goto()" class="active list-group-item list-group-item-action" id="button-goto">
		加密
	</a><a href="javascript:back()" class="list-group-item list-group-item-action" id="button-back">
		解密
	</a>
	</div>
	<script>
	if (localStorage.getItem("zyxOT-v1-username") == null) {
		if (localStorage.getItem("zyxOT-v1-guest-see_domain") == "true" || localStorage.getItem("zyxOT-v1-guest-manage") == "true") {
			document.write('<div class="mt-3 list-group">');
			if (localStorage.getItem("zyxOT-v1-guest-manage") == "true") 
				document.write('<a href="manage.html?script" class="list-group-item list-group-item-action" id="button-goto">				脚本			</a>');
			if (localStorage.getItem("zyxOT-v1-guest-see_domain") == "true") 
				document.write('<a href="domain.html?status" class="list-group-item list-group-item-action" id="button-goto">				管理			</a>	</div>');
			document.write('</div>');
		}
	}
	else {
		if (localStorage.getItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?manage") == 1 || localStorage.getItem("zyxOT-v1-default-see_domain") == "true" || localStorage.getItem("zyxOT-v1-default-manage") == "true") {
			document.write('<div class="mt-3 list-group">');
			if (localStorage.getItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?manage") == 1 || localStorage.getItem("zyxOT-v1-default-manage") == "true") 
				document.write('<a href="manage.html?script" class="list-group-item list-group-item-action" id="button-goto">				脚本			</a>');
			if (localStorage.getItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?manage") == 1 || localStorage.getItem("zyxOT-v1-default-see_domain") == "true") 
				document.write('<a href="domain.html?status" class="list-group-item list-group-item-action" id="button-goto">				管理			</a>	</div>');
			document.write('</div>');
		}
	}
	</script>
	<script>
function goto() {
	$("title").html('加密 - 在线加密系统');
	$("#tab-goto").addClass('active');
	$("#tab-back").removeClass('active');
	$("#button-goto").addClass('active');
	$("#button-back").removeClass('active');
}
function back() {
	$("title").html('解密 - 在线加密系统');
	$("#tab-back").addClass('active');
	$("#tab-goto").removeClass('active');
	$("#button-back").addClass('active');
	$("#button-goto").removeClass('active');
}
	</script>
			</div>
		</div>
	</div>
<div class="alert alert-danger mt-4">
	<h4>注意</h4>
	<p>本平台的所有算法都不具有安全性，请勿用于情报战等关键场景，如果因为加密问题引发情报泄露，本平台概不负责。</p>
	<p>All algorithms on this platform are not secure and should not be used in critical scenarios such as intelligence warfare. If intelligence leakage occurs due to encryption issues, this platform is not responsible.</p>
	<p>Все алгоритмы Платформы не являются безопасными и не должны использоваться в критических сценариях, таких как разведывательные войны, и Платформа не несет ответственности за утечку информации из - за проблем с шифрованием.</p>
	<p>当プラットフォームのすべてのアルゴリズムは安全性を持っていないので、情報戦などの重要なシーンには使用しないでください。暗号化問題で情報漏洩が発生した場合、当プラットフォームは一切責任を負いません。</p>
</div>
</div>


</div>
	<script>
	if (localStorage.getItem("zyxOT-v1-username") == null && localStorage.getItem("zyxOT-v1-guest-translation") != "true") {
		document.querySelector("title").innerHTML = "403 - 在线加密系统";
		document.querySelector(".uoj-content").innerHTML = '<div class="text-center"><div style="font-size:233px">403</div><p>禁止入内！ T_T</p></div>			';
	}
	else if (localStorage.getItem("zyxOT-v1-username") != null && localStorage.getItem("zyxOT-v1-user=" + localStorage.getItem("zyxOT-v1-username") + "?manage") != 1 && localStorage.getItem("zyxOT-v1-default-translation") != "true") {
		document.querySelector("title").innerHTML = "403 - 在线加密系统";
		document.querySelector(".uoj-content").innerHTML = '<div class="text-center"><div style="font-size:233px">403</div><p>禁止入内！ T_T</p></div>			';
	}
	</script>
	<footer class="bg-body text-muted pt-3 pb-4 mt-4" style="font-size: 0.9em">
		<div class="container d-lg-flex justify-content-lg-between">
			<div>
				<div>
					&copy; 2025					<a class="text-decoration-none" href="../ot.zyx.top.html">zyxOT</a>
				</div>
				<div class="small mt-1" id="web-time">
					服务器时间: 2025-08-23 14:00:45				</div>
			</div>
			<div class="mt-2 mt-lg-0">
				Based on <a class="text-decoration-none" href="https://uoj.ac" target="_blank">UOJ</a> &
				<a class="text-decoration-none" href="https://sjzezoj.com" target="_blank">S2OJ</a>,
				modified by <a class="text-decoration-none" href="../ot.zyx.top/user.html?zhangyunxiang" target="_blank">zhangyunxiang</a> & <a class="text-decoration-none" href="../ot.zyx.top/user.html?Hussein" target="_blank">Hussein</a>
				for <a class="text-decoration-none" href="../ot.zyx.top.html" target="_blank">zyxOT</a>
			</div>
		</div>
		<script src="../ot.zyx.top/js/system.js"></script>
	</footer>
</div>
<!-- /container -->
</body>

</html>